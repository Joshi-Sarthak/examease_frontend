<div class="result-container">

  <div class="header-bar">
    <button class="back-btn" (click)="goBack()">‚Üê Back</button>
    <h2>Test Results</h2>
    <button class="export-btn" (click)="exportCSV()">üì• Download CSV</button>
  </div>

  <div *ngIf="isLoading">Loading...</div>

  <div *ngIf="studentsInClassroom.length === 0 && !isLoading">
    Classroom is empty
  </div>

  <div class="stats-container">
    <h3>Class Performance Stats</h3>
    <ul>
      <li><strong>Total Students:</strong> {{ totalStudents }}</li>
      <li><strong>Students Attempted:</strong> {{ studentsAttempted }}</li>
      <li><strong>Students Not Attempted:</strong> {{ studentsNotAttempted }}</li>
      <li><strong>Class Average Score:</strong> {{ classAverage | number: '1.2-2' }}%</li>
      <li><strong>Highest Score:</strong> {{ highestScore }}</li>
      <li><strong>Lowest Score:</strong> {{ lowestScore }}</li>
    </ul>
  </div>

  <table *ngIf="!isLoading && results.length > 0" class="result-table">
    <thead>
      <tr>
        <th>Student Name</th>
        <th>Score</th>
        <th>Total</th>
        <th>Percentage</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let result of results">
        <td>{{ result.studentName }}</td>
        <td>{{ result.score }}</td>
        <td>{{ result.total }}</td>
        <td>{{ (result.score / result.total) * 100 | number: '1.2-2' }}%</td>
        <td>
          <button (click)="viewStudentResult(result.studentId)" class="review-button">
            Review
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <button (click)="goBack()" class="back-button">Back to Tests</button>
</div>
